A partir da descri√ß√£o das caracter√≠sticas do SAD SustenAgro (Se√ß√£o
\ref{sec:SAD-SustenAgro}), do requisito de modelar o conhecimento
atrav√©s de ontologias (usando tecnologias da Web Sem√¢ntica) e de definir
uma DSL para facilitar a defini√ß√£o de comportamentos por parte dos
especialistas, foi modelado e desenvolvido um prot√≥tipo de um framework,
intitulado Decisioner, que permite definir e gerar SADs do tipo do
SustenAgro. O framework Decisioner √© basicamente formado por ontologias,
que representam conhecimento do dom√≠nio, e por uma DSL que permite
definir comportamentos e estabelecer configura√ß√µes gerais de um SAD.

Satisfazer os requisitos requeridos pelos pesquisadores da Embrapa
Meio Ambiente foi uma das for√ßas que dirigiram o desenvolvimento desta
pesquisa. Para chegar a arquitetura, aqui apresentada, houve um trabalho
interativo para chegar aos requisitos que eram gerais, que deveriam
estar no framework, e os que eram espec√≠ficos, que deveriam estar
definidos na ontologia ou na DSL do SustenAgro. 

Neste cap√≠tulo ser√° apresentado a arquitetura do prot√≥tipo Decisioner,
cada uns dos seus componentes e funcionalidades e as contribui√ß√µes
para esta pesquisa.

\section{Arquitetura do Decisioner}

Os SADs, segundo a descri√ß√£o feita no cap√≠tulo \ref{chap:SAD}, s√£o
compostos por banco de dados, base de conhecimento, m√≥dulo de processamento
da informa√ß√£o e m√≥dulo gerador de resultados. Em cada um desses m√≥dulos,
est√° impl√≠cito o conhecimento dos especialistas, pelo qual a primeira
caracter√≠stica definida do Decisioner foi a integra√ß√£o de ontologias. 

As ontologias permitem a defini√ß√£o do conhecimento dos especialistas
em um componente independente. Ele √© complementado pela DSL, que permite
definir comportamento e caracter√≠sticas do SAD. O diagrama para a
arquitetura desenvolvida para essa solu√ß√£o √© apresentado na figura
\ref{fig:Arquitectura-do-decisioner}. Com base nesse diagrama, os
componentes dos SADs foram generalizados e, por meio do desenvolvimento
de experimentos, foi definida uma arquitetura que pode ser reusada
em diferentes SADs (do mesmo tipo do SustenAgro).

O Decisioner pode ser classificado como um framework. J√° que √© uma
plataforma de software com design reutiliz√°vel e implementa√ß√µes reutiliz√°veis
pelos clientes, que o especializam em um dom√≠nio particular \citep{RiehlePhdthesis}.

A arquitetura do framework Decisioner √© composta pelos componentes
gerais para a defini√ß√£o de SADs, apresentados na Figura \ref{fig:Arquitectura-do-decisioner}.
Usu√°rios especialistas podem interagir com o framework atrav√©s dos
editores de ontologias e DSL. Usu√°rios finais interagem atrav√©s da
sua interface Web.

\begin{figure}[H]
\centering{}\includegraphics[width=0.9\columnwidth]{\string"figures/Decisioner Architecture\string".eps}\caption{Arquitetura do Decisioner\label{fig:Arquitectura-do-decisioner}}
\end{figure}

Os componentes dessa arquitetura s√£o:
\selectlanguage{english}%
\begin{enumerate}
\item \textbf{Domain ontology}\foreignlanguage{brazil}{: representa os conceitos
espec√≠ficos dos especialistas que ser√£o utilizados no SAD.}
\item \textbf{Decisioner ontology}\foreignlanguage{brazil}{: faz uma liga√ß√£o
entre os tipos de dados e as interfaces gr√°ficas capazes de mostrar
ou editar esses dados, fazendo um mapeamento entre os dois.}
\item \textbf{Ontology Editor}\foreignlanguage{brazil}{: componente que
permite editar as ontologias em um formato mais f√°cil para o uso pelos
especialistas.}
\item \textbf{Triplestore}\foreignlanguage{brazil}{: sistema de armazenamento
e recupera√ß√£o da informa√ß√£o em formato de triplas }RDF\foreignlanguage{brazil}{,
(explicado em detalhe na se√ß√£o \ref{subsec:Triplestore}). Ele permite
o gerenciamento de dados e ontologias em formato }RDF.\foreignlanguage{brazil}{
Atrav√©s da linguagem padr√£o }SPARQL Protocol and RDF Query Language
(Sparql)\foreignlanguage{brazil}{ \citep{prud2006sparql}. }
\item \textbf{DSL code}\foreignlanguage{brazil}{: representa uma instancia
da DSL com as defini√ß√µes particulares para um SAD espec√≠fico.}
\selectlanguage{brazil}%
\item \textbf{DSL Editor}: Editor visual web da DSL com recursos como \foreignlanguage{english}{code
completion} e \foreignlanguage{english}{syntax coloring}. Permite
a edi√ß√£o da \foreignlanguage{english}{DSL} por parte dos especialistas
do dom√≠nio.
\selectlanguage{english}%
\item \textbf{Web components}:\foreignlanguage{brazil}{ conjunto de elementos
visuais que podem ser reusados nos SADs com a finalidade de modularizar
e simplificar a gera√ß√£o de }Web User Interfaces\foreignlanguage{brazil}{
(UI\nomenclature{UI}{User Interface}).}
\item \textbf{DSL Interpreter}\foreignlanguage{brazil}{: Interpretador da
DSL para processar as defini√ß√µes do SAD e criar um SAD espec√≠fico.
Ele usa a DSL, ontologias e componentes web para gerar automaticamente
a interface e comportamento de um SAD espec√≠fico.}
\item \textbf{Web UI}\foreignlanguage{brazil}{: Interfaces visuais geradas
pelo }DSL Interpreter.\foreignlanguage{brazil}{ Utilizam os }Web Components\foreignlanguage{brazil}{
e fornecer a interface gr√°fica, usadas pelos usu√°rios finais, na intera√ß√£o
com o SAD na Web.}
\end{enumerate}
\selectlanguage{brazil}%
Essa arquitetura foi implementada em um prot√≥tipo Decisioner. Sempre
que poss√≠vel, na implementa√ß√£o do Decisioner, foram reutilizados componentes
ou bibliotecas dispon√≠veis publicamente na internet.

\section{Metodologia}

Com a finalidade de desenvolver o prot√≥tipo do framework Decisioner,
escolheu-se o SAD SustenAgro como um caso de uso e exemplo de instancia√ß√£o.
Ele permitiu a defini√ß√£o de uma metodologia de desenvolvimento para
os componentes. Teria sido interessante instanciar o framework para
um segundo SAD, para demonstrar melhor sua generalidade. Contudo,
dada as limita√ß√µes de tempo impostas a um trabalho de mestrado e ao
tempo necess√°rio ao desenvolvimento do framework, isso n√£o foi poss√≠vel.
No decorrer deste texto, foram feitas algumas considera√ß√µes sobre
a generalidade do framework. A metodologia abordada durante este processo,
incluiu as seguintes etapas:
\begin{enumerate}
\item Sele√ß√£o da \foreignlanguage{english}{Triplestore}: foram avaliadas
as \foreignlanguage{english}{triplestores} existentes com a finalidade
de definir uma que se adaptasse aos requisitos do framework.
\item Sele√ß√£o da linguagem de programa√ß√£o e framework web: foi realizada
uma verifica√ß√£o das tecnologias de desenvolvimento de sistemas web
compat√≠veis com as tecnologias da web sem√¢ntica e com a \foreignlanguage{english}{DSL}.
\item Design da DSL: Durante o processo de desenvolvimento do SAD SustenAgro,
foram generalizados seus componentes, permitindo definir cada uma
das caracter√≠sticas da DSL. O processo foi iterativo, permitindo refinar
a expressividade da linguagem com a ajuda de especialistas da Embrapa.
\item Desenvolvimento do \foreignlanguage{english}{DSL editor}: implementa√ß√£o
de uma \foreignlanguage{english}{web UI} que permite editar a DSL
em formato textual, fornecendo aos especialistas um editor moderno.
Modifica√ß√µes na DSL podem ser vistas no SAD imediatamente.
\item Desenvolvimento do \foreignlanguage{english}{Ontology Editor}: implementa√ß√£o
de uma \foreignlanguage{english}{web UI} com componentes espec√≠ficos
para suportar a edi√ß√£o das ontologias, por parte dos especialistas,
em um formato textual.
\item Desenvolvimento do \foreignlanguage{english}{DSL Interpreter}: o interprete
da Decisioner DSL. Esse componente tinha que ser atualizado a medida
que o design da DSL mudava.
\item Integra√ß√£o com \foreignlanguage{english}{web components} e \foreignlanguage{english}{web
UI}s: \foreignlanguage{english}{Widgets} gr√°ficas, na forma de \foreignlanguage{english}{Web
components} suportam a gera√ß√£o das \foreignlanguage{english}{Web UIs}
que comp√µem os SADs. \foreignlanguage{english}{Widgets} foram adicionadas
para atender as necessidades do SustenAgro.
\end{enumerate}
A metodologia de desenvolvimento foi guiada pelo desenvolvimento do
SAD SustenAgro. Primeiramente foram desenvolvidas as ontologias, continuando
com o desenvolvimento do \foreignlanguage{english}{DSL Interpreter}
e depois com a integra√ß√£o dos \foreignlanguage{english}{web components}
e \foreignlanguage{english}{UI}s. Foram realizados v√°rios ciclos de
desenvolvimento para refinar as funcionalidades. A Figura \ref{fig:Metodologia-do-Decisioner}
representa a metodologia realizada.

\begin{figure}
\begin{centering}
\includegraphics[width=0.9\columnwidth]{\string"figures/Decisioner Methodology\string".eps}
\par\end{centering}
\caption{Metodologia de desenvolvimento do Decisioner\label{fig:Metodologia-do-Decisioner}}

\end{figure}

A seguir, cada componente da arquitetura do Decisioner √© discutido,
come√ßando pela ontologia Decisioner.

\section{Ontologia Decisioner\label{sec:Ontologia-Decisioner}}

Para desenvolver um prot√≥tipo de uma ontologia geral, que abstra√≠sse
os conceitos dos SADs, foram analisados os sistemas SAD desenvolvidos
pela Embrapa Meio Ambiente, descritos na se√ß√£o \ref{sec:SAD-SustenAgro}.

A vers√£o inicial da ontologia foi modelada na ferramenta Prot√©g√©,
no formato \foreignlanguage{english}{OWL}. Depois foi criado um novo
formato, usando o \foreignlanguage{english}{YAML Ain't Markup Language
(YAML \nomenclature{YAML}{YAML Ain't Markup Language\\})}, mais simples
que \foreignlanguage{english}{OWL}, para ser usado pelos especialistas
no \foreignlanguage{english}{Ontology Editor}, explicado na se√ß√£o
\ref{sec:Ontology-Editor}.

A ontologia Decisioner cont√©m os elementos comuns identificados e
abstra√≠dos dos SADs da Embrapa, e tem o proposito de fornecer uma
ontologia geral que d√™ suporte a SADs diferentes. 

\begin{figure}[H]
\centering{}\includegraphics[scale=0.7]{\string"figures/DSS ontology\string".eps}\caption{Modelagem abstrata do SAD\label{fig:Modelagem-do-SAD}}
\end{figure}

Na Figura \ref{fig:Modelagem-do-SAD}, √© apresentada a hierarquia
de classes resultante. Ela cont√©m as classes:
\selectlanguage{english}%
\begin{description}
\item [{Evaluation\ Object\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa os objetos que ser√£o analisados em cada processo de
avalia√ß√£o. Eles ser√£o indiv√≠duos dessa classe ou de alguma subclasse
dela.}
\item [{Feature\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa as carater√≠sticas a avaliar em um }Evaluation Object.\foreignlanguage{brazil}{
Elas ser√£o quantificadas, analisadas e usadas no processo de gera√ß√£o
de relat√≥rios no processo de avalia√ß√£o. As }Features\foreignlanguage{brazil}{
t√™m associado um }Value\foreignlanguage{brazil}{ que as quantifica.
Existe a subclasse }\textit{Weighted}\foreignlanguage{brazil}{ que
representa uma }Feature\foreignlanguage{brazil}{ vinculada a um peso.
Esse peso pode ser usado nas f√≥rmulas para o c√°lculo dos modelos codificados
pelos especialistas.}
\item [{Place\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa a localiza√ß√£o f√≠sica dos objetos modelados, permitindo
referenciar geograficamente um }Evaluation Object.
\item [{Analysis\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa uma avalia√ß√£o associada a um }Evaluation Object\foreignlanguage{brazil}{.
Suas inst√¢ncias t√™m propriedades, como nome e data da avalia√ß√£o, e
correspondem a uma avalia√ß√£o cadastrada.}
\item [{Value\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa os valores que s√£o atribu√≠dos a cada inst√¢ncia de }Feature.\foreignlanguage{brazil}{
As subclasses }Real\foreignlanguage{brazil}{ e }Categorical\foreignlanguage{brazil}{
representam tipos de valores.}
\item [{User\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa os usu√°rios do sistema.}
\item [{Role\foreignlanguage{brazil}{:}}] \foreignlanguage{brazil}{classe
que representa os pap√©is de usu√°rio do sistema e suas permiss√µes.
Por padr√£o, est√£o instanciados os perfis }User\foreignlanguage{brazil}{
e }Admin.
\end{description}
\selectlanguage{brazil}%
A partir dessas classes √© poss√≠vel organizar os conceitos espec√≠ficos
de cada SAD como subclasses delas. Um aspecto importante das ontologias
√© que suportam a infer√™ncia de novos conhecimentos, permitindo classificar
e relacionar dados novos do sistema, ajudando desta maneira na automatiza√ß√£o
da gera√ß√£o dos SADs. Isso permite ao \foreignlanguage{english}{DSL
Interpreter} mapear qualquer conceito novo, espec√≠fico de um SAD em
particular, a um desses conceitos conhecidos e saber o que deve ser
feito com ele. 
\selectlanguage{english}%

\section{Ontology Editor\label{sec:Ontology-Editor}}

\selectlanguage{brazil}%
Para suportar a edi√ß√£o das ontologias do dom√≠nio, por parte dos especialistas,
foi implementado um editor web. Ele permite editar a ontologia espec√≠fica
do SAD em um formato baseado em \foreignlanguage{english}{YAML,} a
descri√ß√£o da ontologia neste formato passa a um conversor para ficar
no formato \foreignlanguage{english}{OWL} que √© processado pela \foreignlanguage{english}{API}
de prot√©g√© para instanciar a ontologia com as restri√ß√µes definidas
e finalmente exportado como \foreignlanguage{english}{RDF} para ser
substitu√≠do na \foreignlanguage{english}{triplestore} \foreignlanguage{english}{Blazegraph,}
este processo √© realizado a cada vez que o usu√°rio salva a ontologia.

A Figura \ref{fig:Editor-de-ontologia} mostra uma imagem do editor.
Ela mostra o c√≥digo da ontologia em formato \foreignlanguage{english}{YAML},
um \foreignlanguage{english}{side panel,} que apresenta as classes,
propriedades e indiv√≠duos hierarquicamente (permitindo a referencia√ß√£o
dos elementos no c√≥digo), um \foreignlanguage{english}{button restore}
para restituir a ultima vers√£o da ontologia e um \foreignlanguage{english}{button
save} para salvar e carregar no Decisioner a ontologia em edi√ß√£o.

Idealmente, especialistas de dom√≠nio deveriam poder criar a ontologia
usando um editor gr√°fico. Mas devido as restri√ß√µes de escopo de um
projeto de mestrado, n√£o haveria tempo para criar um. A cria√ß√£o de
uma ferramenta, como um editor gr√°fico, teria o escopo de um novo
mestrado. 

Usar um editor para \foreignlanguage{english}{OWL}, como o Prot√©g√©,
exigiria que os especialistas de dom√≠nio aprendessem \foreignlanguage{english}{OWL}
e l√≥gica descritiva, o que n√£o √© uma op√ß√£o vi√°vel. Este editor de
ontologias √© uma solu√ß√£o intermedi√°ria. Ele adota um formato em \foreignlanguage{english}{YAML},
menos complexo que \foreignlanguage{english}{OWL}, mas expressivo
o suficiente para as necessidades das ontologias. Ele ajuda os usu√°rios
a encontrar os elementos da ontologia (\foreignlanguage{english}{side
panel}) e permite a inser√ß√£o da ontologia no Decisioner. Apesar de
ser poss√≠vel aos especialistas desenvolver uma ontologia totalmente
nova, usando o editor, seu objetivo √© permitir que eles possam fazer
modifica√ß√µes localizadas nas ontologias. 

A ontologia definida em este editor ser√° usada para definir a estrutura
dos SADs, as funcionalidades dos SADs s√£o descritas na DSL apresentada
a seguir.
\begin{flushleft}
\begin{figure}[H]
\begin{centering}
\includegraphics[width=1\columnwidth]{figures/SustenAgro-ontology-editor}
\par\end{centering}
\caption{Editor de ontologia\label{fig:Editor-de-ontologia} }
\end{figure}
\par\end{flushleft}

\section{Decisioner DSL}

Para permitir que os especialistas definam o comportamento do framework
Decisioner, foi definida uma DSL que permite definir as principais
caracter√≠sticas de um SAD. Tal DSL foi baseada na modelagem geral
da arquitetura do \foreignlanguage{english}{Decisioner} e permite
relacionar conceitos espec√≠ficos dos especialistas, criar equa√ß√µes
para os modelos usados, gerar a interface web para o usu√°rio final,
servindo de interface entre a ontologia do Decisioner e a ontologia
do dom√≠nio.

A DSL foi baseada na linguagem \foreignlanguage{english}{Groovy},
porque ela suporta o desenvolvimento de \foreignlanguage{english}{DSLs}
que se comportam como extens√µes da linguagem \foreignlanguage{english}{Groovy}.

O uso da DSL, por parte especialistas, diminui o esfor√ßo necess√°rio
no desenvolvimento de um SAD. Ela permite que os pr√≥prios especialistas
sejam capazes de fazer parte do desenvolvimento e valida√ß√£o do SAD.
Especialmente na parte de refinamento e atualiza√ß√£o do SAD, especialistas
podem fazer modifica√ß√µes no sistema sem a ajuda de programadores e
ver o resultado dessas mudan√ßas imediatamente.

As instru√ß√µes definidas na DSL s√£o:
\selectlanguage{english}%

\subsection*{Evaluation Object}

\selectlanguage{brazil}%
Nos SAD focados na avalia√ß√£o, existe um objeto de avalia√ß√£o que representa
as entidades a serem avaliadas. Esse objeto √© constitu√≠do por propriedades
que especificam o que est√° sendo avaliado. A instru√ß√£o \foreignlanguage{english}{\textit{evaluationObject}}\textit{
}permite definir as propriedades desse objeto. Por exemplo, caso uma
fazenda esteja sendo avaliada, √© poss√≠vel criar propriedades como
nome, tipo de produ√ß√£o, localiza√ß√£o, etc.

A instru√ß√£o tem como argumentos a URI (ou label) da classe da ontologia
do dom√≠nio, que ser√° objeto de avalia√ß√£o, e cada uma das propriedades
relacionadas. A Listagem \ref{lis:Defini=0000E7=0000E3o-do-Evaluation}
apresenta um exemplo que usa a classe \textit{ProductionUnit}, como
classe dos objetos a serem avaliados e define as propriedades \textit{hasName},
para nome, e \textit{hasAgriculturalProductionSystem}, para tipo de
produ√ß√£o. Podem ser usados os labels das propriedades, ao inv√©s de
suas URIs\textit{.}

\begin{algorithm}[H]
\inputencoding{latin9}\begin{lstlisting}[caption={DefiniÁ„o do Evaluation Object},label={lis:Defini=0000E7=0000E3o-do-Evaluation}]
evaluationObject ":ProductionUnit", {     
 instance "ui:hasName', label: ["en": "Name", "pt": "Nome"]
 instance ":hasAgriculturalProductionSystem"
 type label: ["en": "Type", "pt": "Tipo"]
}
\end{lstlisting}
\inputencoding{utf8}\end{algorithm}

O comando \foreignlanguage{english}{\textit{instance}} vincula uma
propriedade definida na ontologia, atrav√©s da URI. Ela pode ser complementada
por par√¢metros que customizam a representa√ß√£o visual da propriedade.
O comando \foreignlanguage{english}{\textit{type}} faz com que os
\foreignlanguage{english}{EvaluationObject} tenham que ser de subclasses
da classe principal. Por exemplo, uma unidade produtiva pode ser uma
planta√ß√£o greenfield (mecanizada e uniforme), fazenda familiar, etc.
Os par√¢metros que podem complementar as instru√ß√µes anteriores s√£o:
\selectlanguage{english}%
\begin{enumerate}
\item \textit{required}\foreignlanguage{brazil}{: define uma propriedade
obrigat√≥ria}
\item \textit{label}\foreignlanguage{brazil}{: define um texto associado}
\item \textit{placeholder}\foreignlanguage{brazil}{\textit{:} define um
texto de ajuda}
\item \textit{widget}\foreignlanguage{brazil}{: define um controle gr√°fico
de usu√°rio}
\end{enumerate}

\subsection*{Feature}

\selectlanguage{brazil}%
A instru√ß√£o \foreignlanguage{english}{\textit{Feature}} define as
caracter√≠sticas, do Evaluation Object, que ser√£o usadas na sua avalia√ß√£o.
O DSL Interpreter vai gerar uma interface gr√°fica, onde o usu√°rio
final ter√° que preencher os dados sobre cada caracter√≠stica. Cada
caracter√≠stica tem um tipo associado a ela (na ontologia de dom√≠nio).
A partir dele, √© poss√≠vel associar uma widget espec√≠fica para edi√ß√£o.
Por exemplo, a Figura \ref{fig:Widgets-geradas-da-DSL} mostra a widget
para uma caracter√≠stica que tem um tipo categ√≥rico (Controle biol√≥gico
de pragas) com 2 poss√≠veis valores (Sim e N√£o). Os textos mostrados
v√™m da ontologia e fazem parte da descri√ß√£o de cada elemento. √â poss√≠vel
criar descri√ß√µes em mais de uma l√≠ngua.

\begin{figure}[H]
\begin{centering}
\includegraphics[width=0.8\columnwidth]{figures/IndicatorSelection}
\par\end{centering}
\caption{Widget geradas a partir da defini√ß√£o da DSL\label{fig:Widgets-geradas-da-DSL}}
\end{figure}

Quando o usu√°rio final usa a widget, o valor escolhido √© anotado,
no Evaluation Object, usando a propriedade \foreignlanguage{english}{\textit{has
value}}. Nas f√≥rmulas, usadas para os c√°lculos do modelo usado, √©
poss√≠vel acessar esses valores. Os usu√°rios n√£o precisam preencher
a todas as caracter√≠sticas.

\begin{algorithm}[H]
\inputencoding{latin9}\begin{lstlisting}[caption={DefiniÁ„o de Features },label={lis:Defini=0000E7=0000E3o-de-Features}]
feature ':EnvironmentalIndicator', 'extraFeatures': true
\end{lstlisting}
\inputencoding{utf8}\end{algorithm}

O comando tem como argumento uma URI (ou label) (Listagem \ref{lis:Defini=0000E7=0000E3o-de-Features})
que vincula todas as subclasses da classe referenciada. O par√¢metro
opcional \foreignlanguage{english}{\textit{extraFeatures}} permite
ativar a inser√ß√£o de novas\foreignlanguage{english}{\textit{ features}},
por parte do usu√°rio do SAD. 
\selectlanguage{english}%

\subsection*{Report}

\selectlanguage{brazil}%
O comando \foreignlanguage{english}{\textit{Report}} permite definir
as f√≥rmulas e procedimentos matem√°ticas necess√°rios para o c√°lculo
do modelo usado pelos especialistas de dom√≠nio, e como os resultados
ser√£o apresentados (Listagem \ref{lis:Defini=0000E7=0000E3o-da-l=0000F3gica}).
F√≥rmulas e procedimentos para modelagem matem√°tica s√£o de responsabilidade
dos especialistas de dom√≠nio. A DSL permite desde f√≥rmulas simples,
de uma linha, at√© o uso de bibliotecas complexas, chamadas usando
a JVM. Como a DSL √© uma extens√£o da linguagem Groovy, qualquer comando
da linguagem pode ser usado nela, incluindo opera√ß√µes l√≥gicas e aritm√©ticas.
Para facilitar o trabalho dos especialistas de dom√≠nio, recomenda-se
encapsular qualquer algoritmo ou chamada de fun√ß√£o mais complicados
em um comando simples.

As f√≥rmulas usadas t√™m acesso a todos os dados associados √†s \foreignlanguage{english}{\textit{Features}},
pelos usu√°rios finais. Esses dados s√£o usados no modelo adotado e
podem gerar m√∫ltiplos resultados de avalia√ß√£o. Na Listagem \ref{lis:Defini=0000E7=0000E3o-da-l=0000F3gica},
o comando \textit{weightedSum(data.':EnvironmentalIndicator')} calcula
a m√©dia ponderada de todos os indicadores ambientais fornecidos pelo
usu√°rio final. Esse comando foi criado para simplificar o trabalho
dos especialistas. Biblioteca de comandos, como essa, podem ser adicionadas
ao framework ou criados a pedido dos especialistas.

\begin{algorithm}[H]
\inputencoding{latin9}\begin{lstlisting}[caption={DefiniÁ„o da lÛgica de avaliaÁ„o.},label={lis:Defini=0000E7=0000E3o-da-l=0000F3gica}]
report {     
 environment = weightedSum(data.':EnvironmentalIndicator')
 economic = weightedSum(data.':EconomicIndicator')
 social = weightedSum(data.':SocialIndicator')
 sustainability = (environment + social + economic)/3
 ...
}
\end{lstlisting}
\inputencoding{utf8}\end{algorithm}

Os resultados do processo de avalia√ß√£o podem ser apresentados por
meio de v√°rias \foreignlanguage{english}{\textit{widgets}} que facilitam
a representa√ß√£o e compreens√£o dos resultados da avalia√ß√£o. No algoritmo
\ref{lis:Defini=0000E7=0000E3o-dos-componentes} o comando \textit{sustainabilityMatrix
x: sustainability, y: efficiency} apresenta os valores das vari√°veis
\textit{sustainability} e \textit{efficiency} em um gr√°fico de matriz
de sustentabilidade (Figura \ref{fig:Matriz-de-sustentabilidade-widget}).
Para executar esse comando, o DSL Interpreter simplesmente coloca
a widget \textit{suatainabilityMatrix} na UI e passa os valores das
vari√°veis, como atributos. A widget vai ser respons√°vel por criar
o gr√°fico. Essas widgets gr√°ficas podem ser criadas como Web Components
padr√£o (HTML 5) ou componentes do framework Grails (Se√ß√£o \ref{sec:Web-components}).
O framework vem com um conjunto de widgets predefinidos, mas novas
podem ser adicionadas. 

\begin{algorithm}[H]
\inputencoding{latin9}\begin{lstlisting}[caption={DefiniÁ„o dos componentes visuais do relatÛrio.},label={lis:Defini=0000E7=0000E3o-dos-componentes}]
report {
 ...
 sustainabilityMatrix x: sustainability, y: efficiency
 text 'en': 'Microregion map', 'pt': 'Mapa da microregi„o'
 map data.'Microregion'
}
\end{lstlisting}
\inputencoding{utf8}\end{algorithm}

Por meio dos comandos da DSL, √© poss√≠vel definir o comportamento e
as caracter√≠sticas gerais dos SAD. 

Os elementos gr√°ficos (widgets), seja os que representam as Features
ou os usados nos relat√≥rios, s√£o implementados como \foreignlanguage{english}{Web
Components} HTML 5 ou Grails. Isso d√° muita flexibilidade ao framework
Decisioner. A qualquer tempo √© poss√≠vel se acrescentar novas widgets,
para novos tipos de dados (Features) ou gr√°ficos de relat√≥rios. 
\selectlanguage{english}%

\section{DSL Editor}

\selectlanguage{brazil}%
Para suportar a edi√ß√£o da Decisioner DSL, foi implementado um editor
textual web que permite aos especialistas editar e rodar o c√≥digo
da DSL. Ele √© composto por um editor de c√≥digo para a DSL, um \foreignlanguage{english}{button
restore} para carregar novamente a √∫ltima vers√£o v√°lida da DSL e um
\foreignlanguage{english}{button save} para salvar e carregar a DSL
no DSL Interpreter. 

A Figura \ref{fig:Editor-DSL} mostra o editor em a√ß√£o.

\begin{figure}[H]
\begin{centering}
\includegraphics[width=1\columnwidth]{figures/SustenAgro-dsl-editor-2}
\par\end{centering}
\caption{Editor DSL\label{fig:Editor-DSL}}
\end{figure}

O Editor de c√≥digo foi baseado no \foreignlanguage{english}{Ace Editor}\footnote{\url{ttps://ace.c9.io/}},
que fornece \foreignlanguage{english}{syntax highlighting} para v√°rias
linguagens de programa√ß√£o, entre elas Groovy. Como a DSL foi baseada
em Groovy, o editor foi configurado para reconhecer a sintaxe de Groovy.
Tamb√©m foi ativado o suporte para \foreignlanguage{english}{code completion}
para fornecer uma experi√™ncia de uso mais amig√°vel.

A principal vantagem desse editor √© a funcionalidade de salvar a ontologia
e reconfigurar o SAD imediatamente, permitindo uma experi√™ncia em
tempo real de redefini√ß√£o do SAD. Se o usu√°rio errar algo, ele pode
simplesmente restaurar as configura√ß√µes \foreignlanguage{english}{default}.

O editor da DSL tem compatibilidade com \foreignlanguage{english}{Web
Components}, tanto os fornecidos pelas bibliotecas integradas no Framework
Decisioner, como com os \foreignlanguage{english}{Web Components}
do Framework \foreignlanguage{english}{Grails} e, adicionalmente,
podem ser definidos \foreignlanguage{english}{Web Components }especializados.
\selectlanguage{english}%

\section{Web Components\label{sec:Web-components}}

Web Component\foreignlanguage{brazil}{s }\footnote{\selectlanguage{brazil}%
\url{https://www.webcomponents.org/introduction}\selectlanguage{brazil}%
}\foreignlanguage{brazil}{ √© um conjunto de APIs padr√£o para definir
novas tags }HTML\foreignlanguage{brazil}{ personalizadas, reutiliz√°veis
e encapsuladas para o uso em p√°ginas ou aplica√ß√µes web. O framework
Grails tamb√©m disponibiliza o uso de layout templates para implementar
partes reus√°veis de uma view (p√°gina HTML). Com essas duas tecnologias,
√© poss√≠vel a cria√ß√£o de componentes (ou widgets) reus√°veis da UI. }

\selectlanguage{brazil}%
Para suportar a gera√ß√£o de diferentes tipos de SADs, foi necess√°rio
disponibilizar v√°rios tipos de widgets que permitissem visualizar
e editar diferentes tipos de dados. Para relacionar os \foreignlanguage{english}{web
components} com o conhecimento dos especialistas, modelou-se, na ontologia
Decisioner, os \foreignlanguage{english}{data-types} que permitem
relacionar os tipos de dados com widgets espec√≠ficas (capazes de edit√°-los),
usadas nas \foreignlanguage{english}{web UIs} dos SADs gerados. Os
dados das Features dos SADs podem ser de v√°rios tipos e, para cada
tipo, existe uma widget apropriada para visualiza-o. Por exemplo,
para representar uma propriedade de tipo num√©rico discreto √© poss√≠vel
usar uma widget visual tipo \foreignlanguage{english}{spinner}.

Nos relat√≥rios, os especialistas devem contar com widgets para apresentar
seus resultados em v√°rios formatos, como tabelas, mapas, matriz de
sustentabilidade, etc. Essas widgets podem ser espec√≠ficas para um
tipo de SAD em particular. Por isso, al√©m do framework contar com
uma biblioteca de widgets prontas, deve ser poss√≠vel adicionar novas
widgets facilmente. Ao usar padr√µes, como para Web Components, o framework
permite a f√°cil inclus√£o de widgets novas. N√£o se espera que os especialistas
de dom√≠nio criem essas widgets, mas sim que seja f√°cil para eles consegui-las
de desenvolvedores independentes (que s√≥ precisam conhecer o padr√£o
para Web Components e os requisitos da widget). 

O framework Decisioner tem uma biblioteca de \foreignlanguage{english}{web
components} (widget) constru√≠da usando o\foreignlanguage{english}{
web framework Bootstrap }\footnote{\url{http://getbootstrap.com/}},
que conta com diversos componentes b√°sicos para a gera√ß√£o das Web
UI. A maioria deles foi definida usando as \foreignlanguage{english}{layout
templates} do framework \foreignlanguage{english}{Grails}, por ser
mais f√°cil de programar. Atualmente, apenas dois componentes usam
Web Components.
\selectlanguage{english}%

\section{Web UI}

\selectlanguage{brazil}%
A \foreignlanguage{english}{Web UI} √© uma interface web de usu√°rio
respons√°vel por toda a intera√ß√£o com o usu√°rio final. Ela permite
apresentar e editar as informa√ß√µes do SAD, gerar as an√°lises e visualizar
os resultados na web ou em relat√≥rios impressos. O mais importante
√© que ela √© gerada automaticamente pelo DSL Interpreter, usando a
DSL e ontologias particulares a cada SAD. 

A Figura \ref{fig:Web-UI} apresenta uma Web UI que foi gerada automaticamente,
a partir da ontologia e das defini√ß√µes na DSL do SAD SustenAgro. Nela
s√£o apresentados v√°rios tipos de \foreignlanguage{english}{Web Components}
que demostram o suporte a diferentes tipos de dados.

\begin{figure}[H]
\begin{centering}
\includegraphics[width=1\columnwidth]{figures/SustenAgro-tool}
\par\end{centering}
\caption{\foreignlanguage{english}{Web UI \foreignlanguage{brazil}{com} web components\label{fig:Web-UI}}}
\end{figure}

Parte da Web UI √© igual para todos os SADs, como formul√°rios de login.
O resto dela √© gerado com a ajuda dos \foreignlanguage{english}{Web
Components.} Eles s√£o relacionadas aos tipos de dados existentes no
sistema, por meio da ontologia Decisioner. Por exemplo, dados podem
ser dos tipos num√©rico cont√≠nuo, num√©rico discreto, percentagem, booleano,
categ√≥ricos ou alfanum√©rico. Dada essa diversidade, os tipos de dados
foram modelados em ontologias com a finalidade de permitir a adapta√ß√£o
autom√°tica (ou semiautom√°tica) da interface √†s mudan√ßas dos conceitos
do dom√≠nio.

Mudan√ßas no layout geral podem ser feitas tamb√©m atrav√©s da edi√ß√£o
das \foreignlanguage{english}{Cascading Style Sheets (CSS \nomenclature{CSS}{Cascading Style Sheets})}
do Decisioner. √â esperado que, quando da instala√ß√£o do sistema, t√©cnicos
de inform√°tica fa√ßam uma customiza√ß√£o do sistema para adequ√°-lo aos
padr√µes de apresenta√ß√£o da institui√ß√£o. Eles tamb√©m devem incluir
qualquer Web Component (widget) necess√°rio mas n√£o dispon√≠vel por
default no Decisioner. 
\selectlanguage{english}%

\section{DSL Interpreter}

\selectlanguage{brazil}%
O DSL Interpreter √© o principal modulo do framework Decisioner. A
sua principal funcionalidade √© a interpreta√ß√£o das \foreignlanguage{english}{DSLs}.
Ele executa cada uma das instru√ß√µes da DSL, vinculando dados e informa√ß√£o,
das ontologias ou fornecidos pelos usu√°rios finais, aos \foreignlanguage{english}{web
components} com a finalidade de gerar as Web \foreignlanguage{english}{UIs}.

Para interagir com os dados da ontologia e apresenta-los na linguagem
dos especialistas, foi necess√°rio criar, no DSL Interpreter, uma camada
de consulta de dados na \foreignlanguage{english}{triplestore} para
simplificar as consultas SPARQL (Figura \ref{fig:Arquitetura-do-Decisioner-Core}).
Esta camada, Sparql Simplifier, foi desenvolvida como uma solu√ß√£o
eficiente para a recupera√ß√£o de informa√ß√µes sem√¢nticas de um dom√≠nio
de conhecimento usando um formato simplificado. 

O componente \foreignlanguage{english}{DSL Interpreter} processa as
instru√ß√µes dos especialistas na linguagem Decisioner DSL. Foram utilizadas
t√©cnicas padr√µes para a cria√ß√£o de DSLs usando a linguagem \foreignlanguage{english}{Groovy\citep{dearle2015groovy},}
o que facilitou a defini√ß√£o das \foreignlanguage{english}{DSLs}.

Finalmente, o DSL \foreignlanguage{english}{Interpreter} usa o \foreignlanguage{english}{UI
Renderer} para renderizar dinamicamente as Web \foreignlanguage{english}{UIs}
usando os Web \foreignlanguage{english}{Components.} Esse processo
√© repetido toda vez que usu√°rios solicitam uma \foreignlanguage{english}{View}
de um SAD. A figura \ref{fig:Arquitetura-do-Decisioner-Core} apresenta
o DSL Interpreter e os outros m√≥dulos com os quais ele se conecta.

\begin{figure}[H]
\begin{centering}
\includegraphics[width=0.7\columnwidth]{\string"figures/Decisioner Core Architecture\string".eps}
\par\end{centering}
\caption{Arquitetura do DSL Interpreter.\label{fig:Arquitetura-do-Decisioner-Core}}
\end{figure}

A figura \ref{fig:Arquitetura-do-Decisioner-Core} tamb√©m representa
a parte computacional do m√©todo proposto nesta pesquisa para definir
SADs. O m√©todo consiste em representar o conhecimento dos especialistas
em ontologias da web sem√¢ntica e complementar com uma DSL que descreve
os conceitos de \foreignlanguage{english}{evaluation object} com \foreignlanguage{english}{features},
m√©todo de avalia√ß√£o e relat√≥rio de resultados, permitindo desta maneira
definir o SAD por parte dos especialistas.

\section{Considera√ß√µes finais}

Neste cap√≠tulo foram apresentados os principais componentes do Framework
Decisioner, existem caracter√≠sticas dele como o gerenciamento de usu√°rios
e seguran√ßa que foram desenvolvidos, mas n√£o se especificaram porque
n√£o contribu√≠ram de maneria relevante ao desenvolvimento da pesquisa.

O desenvolvimento do Framework Decisioner foi realizado simultaneamente
com o SAD SustenAgro, devido a que era necess√°rio uma instancia para
validar se as funcionalidades foram implementadas corretamente. O
processo teve dificuldades para separar os dois desenvolvimentos pois
tinha componentes em comum, que a partir de um processo iterativo,
foram organizando-se e permitindo separar os dois sistemas.

N√£o foi poss√≠vel instanciar outro sistema no Decisioner durante o
desenvolvimento do mestrado, mas atualmente encontra-se em andamento
a implementa√ß√£o do SAD Nano-Tec como segunda instancia√ß√£o do Framework
Decisioner. O que permitir√° generalizar ainda mais e servir como um
caso de uso adicional para validar as hip√≥teses em outros dom√≠nios.
Esta arquitetura foi validada por meio da instancia√ß√£o do SAD SustenAgro,
o que permite validar se realmente funcionam cada uma das caracter√≠sticas
aqui descritas.

No cap√≠tulo seguinte ser√° apresentado o SAD SustenAgro, gerado como
primeiro caso de uso deste Framework, e depois ser√° apresentado o
processo de avalia√ß√£o que formaliza a avalia√ß√£o deste sistema.
